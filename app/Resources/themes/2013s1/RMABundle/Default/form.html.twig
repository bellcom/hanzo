{% extends layout %}
{% block content %}

<h1>{{ 'rma.form.title.order_id'|trans({'%order_id%': order.id}, 'rma') }}</h1>
<div class="grid_8 alpha omega">
  <div class="basket clearfix">
    {% if order_lines %}
      <table class="product-table">
        <thead>
          <tr>
            <th class="left">{{ "products"|trans }}</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
        {% for product in order_lines %}
          <tr class="item">
            <td class="image left">
            {% if product.basket_image %}
              {{ product_image_tag(product.basket_image, '57x100', { 'alt' : product.products_name }) }}
            {% endif %}
              <div class="info" data-product_id="{{ product.products_id }}" data-confirmed="">
                <span class="title">{{ product.products_name }}</span>
                <div class="size">
                  <label>{{ "size"|trans }}:</label>
                  <span>{{ product.products_size }}</span>
                </div>
                <div class="color">
                  <label>{{ "color"|trans }}:</label>
                  <span>{{ product.products_color }}</span>
                </div>
              </div>
            </td>
            <td class="left actions">
              <form action="#" class="rma-form">
                <label>
                  {{ 'rma.form.label.activitycode'|trans({}, 'rma') }}
                  <select name="product[{{ product.products_id }}][activity_code]" id="activitycode-productid-{{ product.products_id }}" class="rma-activitycode" data-id="{{ product.products_id }}">
                    <option value="" selected>{{ 'rma.form.activity.default'|trans({}, 'rma') }}</option>
                    <option value="return">{{ 'rma.form.activity.return'|trans({}, 'rma') }}</option>
                    <option value="replacement">{{ 'rma.form.activity.replacement'|trans({}, 'rma') }}</option>
                    <option value="warranty">{{ 'rma.form.activity.warranty'|trans({}, 'rma') }}</option>
                  </select>
                </label>

                {#
                  Causes for activities

                  We need a select for each activity. Different causes.
                #}
                <label class="off rma-cause rma-return-causes">
                  {{ 'rma.form.label.cause'|trans({}, 'rma') }}
                  <select name="product[{{ product.products_id }}][return][cause]" id="return-cause-productid-{{ product.products_id }}" data-id="{{ product.products_id }}">
                    <option value="" selected>{{ 'rma.form.cause.default'|trans({}, 'rma') }}</option>
                    {% for cause in 'rma.form.activity.return.causes'|trans({}, 'rma')|split('|') %}
                    <option value="{{ cause }}">{{ cause }}</option>
                    {% endfor %}
                  </select>
                </label>
                <label class="off rma-cause rma-replacement-causes">
                  {{ 'rma.form.label.cause'|trans({}, 'rma') }}
                  <select name="product[{{ product.products_id }}][replacement][cause]" id="replacement-cause-productid-{{ product.products_id }}" data-id="{{ product.products_id }}">
                    <option value="" selected>{{ 'rma.form.cause.default'|trans({}, 'rma') }}</option>
                    {% for cause in 'rma.form.activity.replacement.causes'|trans({}, 'rma')|split('|') %}
                    <option value="{{ cause }}">{{ cause }}</option>
                    {% endfor %}
                  </select>
                </label>
                <label class="off rma-cause rma-warranty-causes">
                  {{ 'rma.form.label.cause'|trans({}, 'rma') }}
                  <select name="product[{{ product.products_id }}][warranty][cause]" id="warranty-cause-productid-{{ product.products_id }}" data-id="{{ product.products_id }}">
                    <option value="" selected>{{ 'rma.form.cause.default'|trans({}, 'rma') }}</option>
                    {% for cause in 'rma.form.activity.warranty.causes'|trans({}, 'rma')|split('|') %}
                    <option value="{{ cause }}">{{ cause }}</option>
                    {% endfor %}
                  </select>
                </label>

                {#
                  Quickorder to select a new product
                #}
                <div class="off rma-productreplacement quickorder">
                  <label>
                    {{ 'rma.form.label.replacement'|trans({}, 'rma') }}<br>
                    <input type="text" id="replacement-master-productid-{{ product.products_id }}" placeholder="{{ 'rma.form.placeholder.produkt'|trans({}, 'rma') }}" class="master">
                  </label>
                  <label class="off">
                    <select id="replacement-size-productid-{{ product.products_id }}" class="size"></select>
                  </label>
                  <label class="off">
                    <select id="replacement-color-productid-{{ product.products_id }}" class="color"></select>
                  </label>
                  <label class="off">
                    {{ 'quickorder.quantity.placeholder'|trans({}, 'quickorder') }}
                    <input type="text" id="replacement-quantity-productid-{{ product.products_id }}" placeholder="{{ 'quickorder.quantity.placeholder'|trans({}, 'quickorder') }}" class="quantity">
                  </label>
                  <div class="autocomplete-container"></div>
                </div>

                {#
                  Description
                #}
                <label class="off rma-description">
                  {{ 'rma.form.label.description'|trans({}, 'rma') }}
                  <textarea name="product[{{ product.products_id }}][description]" id="description-productid-{{ product.products_id }}" data-id="{{ product.products_id }}"></textarea>
                </label>
              </form>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
      <input id="rma-submit" type="button" class="button right" value="{{ 'rma.form.submit'|trans({}, 'rma') }}">
    {% endif %}
  </div>
</div>
{% endblock %}

{% block javascript %}
<script src="{{ asset('/fx/scripts/bootstrap-typeahead.js') }}"></script>
<script>
  var rma_order_id = {{ order.id }};
</script>
{% endblock %}

imports:
    - resource: parameters.ini
    - resource: parameters.php

framework:
    translator: null
    secret: '%secret%'
    router:
        resource: '%kernel.root_dir%/config/routing.yml'
    form: true
    csrf_protection: true
    validation:
        enabled: true
        enable_annotations: true
    templating:
        engines: [twig]
        assets_version: '%assets_version%'
    session: ~

services:
    stock:
        class: Hanzo\Core\Stock
        arguments: [ '@event_dispatcher', '%locale%' ]

    hanzo.cache:
        class: Hanzo\Core\RedisCache
        arguments: [ '@snc_redis.default_client', '%kernel.environment%' ]
    hanzo.misc.twig.extension:
        class: Hanzo\Twig\Extension\MiscExtension
        arguments: ['@twig_string']
        tags:
            -   { name: twig.extension }
    hanzo.asset.twig.extension:
        class: Hanzo\Twig\Extension\AssetExtension
        tags:
            -   { name: twig.extension }
    hanzo.maps.twig.extension:
        class: Hanzo\Twig\Extension\MapsExtension
        arguments: ['@twig_string']
        tags:
            -   { name: twig.extension }

    hanzo.routing_loader:
        class: Hanzo\Bundle\CMSBundle\CMSRouterLoader
        arguments: ['%locale%', '%kernel.cache_dir%']
        tags:
            -   { name: routing.loader }

    hanzo.boot_listener:
        class: Hanzo\Core\HanzoBoot
        arguments: ['@router', '@kernel']
        tags:
            -   { name: kernel.event_listener, event: kernel.request, method: onKernelRequest, priority: -10 }
    hanzo.exception_listener:
        class: Hanzo\Core\ExceptionHandler
        arguments: [@service_container]
        tags:
            -   { name: kernel.event_listener, event: kernel.exception, method: onKernelException }
    hanzo.login_listener:
        class: Hanzo\Bundle\AccountBundle\Event\LoginListener
        arguments: [@security.context]
        tags:
            -   { name: kernel.event_listener, event: security.interactive_login }

twig:
    debug: '%kernel.debug%'
    strict_variables: '%kernel.debug%'

assetic:
    debug: '%kernel.debug%'
    use_controller: false
    java: /usr/bin/java
    sass: %sass_bin%
    node: %node_bin%
    filters:
        cssrewrite: ~
        compass:
            bin: %compass_bin%
            apply_to: "\.scss$"
        #uglifyjs:
        #    bin: %uglifyjs_bin%
        #    no_copyright: false
        #    apply_to: "\.js$"

swiftmailer:
    transport: '%mailer_transport%'
    host: '%mailer_host%'
    username: '%mailer_user%'
    password: '%mailer_password%'

propel:
    dbal:
        driver: '%database_driver%'
        options: {  }
        attributes: {  }
    path: '%kernel.root_dir%/../vendor/propel'
    phing_path: '%kernel.root_dir%/../vendor/phing'
    logging: '%kernel.debug%'

jms_security_extra:
    secure_all_services: false
    expressions: true

# when switching to native redis session handeling
# https://github.com/drak/NativeSession
snc_redis:
    clients:
        default:
            type: predis
            alias: default
            dsn: 'redis://%redis_cache1_host%:%redis_cache1_port%/%redis_cache1_database%'
            options:
                connection_persistent: true
                connection_timeout: 30
                read_write_timeout: 0
        session:
            type: predis
            alias: session
            dsn: 'redis://%redis_session_host%:%redis_session_port%/%redis_session_database%'
            options:
                connection_persistent: true
                connection_timeout: 30
                read_write_timeout: 0
    session:
        client: session
        ttl: 10800
        prefix: hanzo.session
        use_as_default: true

# settings for the cms bundle.
cms:
    frontpage: 556
    twig:
        left_menu:
            type: main
            from: 20
        sub_menu:
            type: sub
            from: 400
            offset: 482
        footer1_menu:
            type: footer1
            thread: 30
        footer2_menu:
            type: footer2
            thread: 31
        footer3_menu:
            type: footer3
            thread: 32

# @see https://github.com/ekino/EkinoNewRelicBundle
ekino_new_relic:
    application_name: Pompdelux
    api_key: 3909fb3d64adf610708e4fc0aa59fc956a94d03a

# @see https://github.com/liip/LiipThemeBundle
liip_theme:
    themes: ['2012s2', '2013s1']
    active_theme: '2013s1'
    path_patterns:
        app_resource:
            - %%app_path%%/themes/%%current_theme%%/%%template%%
            - %%app_path%%/themes/2012s2/%%template%%
            - %%app_path%%/views/%%template%%
        bundle_resource:
            - %%bundle_path%%/Resources/themes/%%current_theme%%/%%template%%
            - %%bundle_path%%/Resources/themes/2012s2/%%template%%
        bundle_resource_dir:
            - %%dir%%/themes/%%current_theme%%/%%bundle_name%%/%%template%%
            - %%dir%%/themes/2012s2/%%bundle_name%%/%%template%%
